<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aabaan's Recipe Book</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@300;400;500;600&display=swap');

        :root {
            --sidebar-width: 300px;
            --primary: #2d3436;
            --secondary: #636e72;
            --accent: #d63031;
            --bg: #FAFAFA;
            --card-bg: #FFFFFF;
            --text-main: #2d3436;
            --text-light: #636e72;
            --shadow: 0 10px 40px rgba(0, 0, 0, 0.06);
            --gradient-red: linear-gradient(135deg, #d63031 0%, #ff7675 100%);
            --glow-red: rgba(214, 48, 49, 0.4);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            margin: 0;
            padding: 0;
            color: var(--text-main);
            overflow-x: hidden;
            display: flex;
            height: 100vh;
        }

        /* SIDEBAR */
        .sidebar {
            width: var(--sidebar-width);
            height: 100vh;
            background: white;
            border-right: 1px solid rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 100;
        }

        .sidebar-header {
            padding: 2.5rem 2rem;
            text-align: center;
        }

        .sidebar-header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            margin: 0;
            color: var(--primary);
            line-height: 1.1;
        }

        .sidebar-header p {
            font-size: 0.75rem;
            color: var(--accent);
            margin: 0.8rem 0 0;
            letter-spacing: 2px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .search-container {
            padding: 0 1.5rem 1.5rem;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #eee;
            border-radius: 50px;
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            outline: none;
            background: #f8f9fa;
            transition: all 0.3s;
        }

        .search-input:focus {
            border-color: var(--accent);
            background: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .nav-list {
            flex: 1;
            overflow-y: auto;
            padding: 0 1rem 3rem;
            list-style: none;
            margin: 0;
        }

        .nav-list::-webkit-scrollbar {
            width: 4px;
        }

        .nav-list::-webkit-scrollbar-thumb {
            background: #eee;
            border-radius: 4px;
        }

        .nav-category {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #b2bec3;
            margin: 2rem 0 0.8rem 1.2rem;
            font-weight: 700;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-light);
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .nav-item:hover {
            background: #fff5f5;
            color: var(--accent);
        }

        .nav-item.active {
            background: var(--accent);
            color: white;
            box-shadow: 0 4px 15px rgba(214, 48, 49, 0.25);
        }

        .nav-item i {
            margin-right: 12px;
            font-size: 0.85rem;
            width: 16px;
            text-align: center;
        }


        /* MAIN CONTENT */
        .main-content {
            margin-left: var(--sidebar-width);
            flex: 1;
            height: 100vh;
            overflow-y: auto;
            padding: 0;
            scroll-behavior: smooth;
        }

        .recipe-view {
            display: none;
            max-width: 1000px;
            margin: 0 auto;
            padding: 4rem 5%;
            animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .recipe-view.active {
            display: block;
        }

        /* Welcome View */
        #welcome-view {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            text-align: center;
            padding: 2rem;
        }

        .welcome-icon {
            font-size: 4rem;
            color: var(--accent);
            margin-bottom: 2rem;
            opacity: 0.2;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.98);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* RECIPE DESIGN */
        .recipe-header {
            text-align: center;
            margin-bottom: 3.5rem;
        }

        .recipe-image-wrapper {
            width: 100%;
            height: 450px;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 2.5rem;
            position: relative;
            background: #f0f0f0;
        }

        .recipe-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 1.5s cubic-bezier(0.19, 1, 0.22, 1);
        }

        .recipe-image-wrapper:hover .recipe-image {
            transform: scale(1.05);
        }

        .recipe-title {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            color: var(--primary);
            margin: 0 0 1.5rem;
            line-height: 1.1;
            letter-spacing: -0.5px;
        }

        .recipe-meta-row {
            display: inline-flex;
            background: white;
            padding: 10px 20px;
            border-radius: 100px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            gap: 2rem;
            border: 1px solid #f0f0f0;
        }

        .meta-tag {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--text-light);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .meta-tag i {
            color: var(--accent);
            font-size: 1rem;
        }

        .recipe-grid {
            display: grid;
            grid-template-columns: 1fr 1.6fr;
            gap: 4rem;
        }

        .ingredients-card {
            background: white;
            padding: 2.5rem;
            border-radius: 20px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(0, 0, 0, 0.03);
            height: fit-content;
        }

        .instructions-card {
            padding: 1rem;
        }

        h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.6rem;
            margin-top: 0;
            margin-bottom: 1.5rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        h3 i {
            color: var(--accent);
            font-size: 1.2rem;
        }

        ul,
        ol {
            padding-left: 0;
            list-style: none;
        }

        .ingredients-list li {
            padding: 12px 0;
            border-bottom: 1px dashed #eee;
            display: flex;
            gap: 12px;
            line-height: 1.5;
            color: #444;
        }

        .ingredients-list li:last-child {
            border-bottom: none;
        }

        .ingredients-list li::before {
            content: "â€¢";
            color: var(--accent);
            font-weight: bold;
        }

        .instructions-list {
            counter-reset: step;
        }

        .instructions-list li {
            position: relative;
            padding-left: 3rem;
            margin-bottom: 2rem;
            line-height: 1.8;
            color: #444;
        }

        .instructions-list li::before {
            counter-increment: step;
            content: counter(step);
            position: absolute;
            left: 0;
            top: 0;
            width: 32px;
            height: 32px;
            background: #fff0f0;
            color: var(--accent);
            border-radius: 50%;
            text-align: center;
            line-height: 32px;
            font-weight: 700;
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
        }

        /* ACTIONS */
        .action-fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: white;
            color: var(--text-main);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            transition: all 0.3s;
            z-index: 90;
            border: none;
            text-decoration: none;
        }

        .action-fab:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
            color: var(--accent);
        }


        /* CHATBOT */
        /* CHATBOTS */
        #chatbot-custom {
            position: fixed;
            bottom: 170px;
            right: 30px;
            top: auto;
            left: auto;
            z-index: 100001;
            font-family: 'Inter', sans-serif;
        }

        #chatbot-main {
            position: fixed;
            bottom: 100px;
            right: 30px;
            z-index: 100000;
            font-family: 'Inter', sans-serif;
        }

        /* Adjust window for bottom-right bot to pop LEFT */
        #chatbot-main .chatbot-window {
            top: auto;
            bottom: 0;
            right: 70px;
            /* Open to the left */
            left: auto;
            transform-origin: bottom right;
            transform: translateX(20px) scale(0.95);
        }

        #chatbot-main .chatbot-window.open {
            transform: translateX(0) scale(1);
        }

        /* Adjust window for custom bot to pop LEFT */
        #chatbot-custom .chatbot-window {
            top: auto;
            bottom: 0;
            right: 70px;
            /* Open to the left */
            left: auto;
            transform-origin: bottom right;
            transform: translateX(20px) scale(0.95);
        }

        #chatbot-custom .chatbot-window.open {
            transform: translateX(0) scale(1);
        }

        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient-red);
            border: none;
            color: white;
            font-size: 1.4rem;
            cursor: pointer;
            position: relative;
            box-shadow: 0 6px 30px var(--glow-red);
            transition: all 0.3s ease;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chatbot-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 40px var(--glow-red);
        }

        .chatbot-pulse {
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            border: 2px solid #ff7675;
            animation: chatbot-ping 2s cubic-bezier(0, 0, 0.2, 1) infinite;
            pointer-events: none;
        }

        @keyframes chatbot-ping {
            0% {
                opacity: 0.7;
                transform: scale(1);
            }

            75%,
            100% {
                opacity: 0;
                transform: scale(1.6);
            }
        }

        .chatbot-window {
            position: absolute;
            top: 76px;
            left: 0;
            width: 450px;
            height: 650px;
            max-width: 90vw;
            max-height: 80vh;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 0, 0, 0.05);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            opacity: 0;
            transform: translateY(-20px) scale(0.95);
            pointer-events: none;
            transition: all 0.35s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .chatbot-window.open {
            opacity: 1;
            transform: translateY(0) scale(1);
            pointer-events: all;
        }

        .chat-header {
            padding: 1.2rem;
            background: #fff0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .chat-header h4 {
            margin: 0;
            color: var(--primary);
            font-family: 'Playfair Display';
        }

        .chat-messages {
            flex: 1;
            padding: 1.2rem;
            overflow-y: auto;
            background: #fafafa;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .chat-msg {
            max-width: 85%;
        }

        .chat-msg.user {
            align-self: flex-end;
        }

        .chat-msg.bot .chat-bubble {
            background: white;
            border: 1px solid #eee;
            color: #333;
            border-radius: 12px 12px 12px 2px;
        }

        .chat-msg.user .chat-bubble {
            background: var(--accent);
            color: white;
            border-radius: 12px 12px 2px 12px;
        }

        .chat-bubble {
            padding: 10px 14px;
            font-size: 0.9rem;
            line-height: 1.5;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.03);
        }

        .chat-input-area {
            padding: 1rem;
            background: white;
            border-top: 1px solid #eee;
            display: flex;
            gap: 10px;
        }

        .chat-input-area input {
            flex: 1;
            padding: 10px 15px;
            border-radius: 20px;
            border: 1px solid #eee;
            outline: none;
        }

        .chat-input-area button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent);
            color: white;
            border: none;
            cursor: pointer;
        }

        /* RESPONSIVE */
        @media (max-width: 1100px) {
            .recipe-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .recipe-image-wrapper {
                height: 350px;
            }
        }

        @media (max-width: 900px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
                box-shadow: 20px 0 50px rgba(0, 0, 0, 0.1);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 0;
            }

            .menu-toggle {
                display: block;
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 200;
                background: white;
                padding: 12px;
                border-radius: 50%;
                box-shadow: var(--shadow);
                cursor: pointer;
                color: var(--primary);
            }

            .recipe-view {
                padding: 6rem 5% 4rem;
            }

            /* Mobile Chatbot Adjustments */
            .chatbot-container {
                top: auto;
                bottom: 20px;
                left: 20px;
            }

            .chatbot-window {
                top: auto;
                bottom: 76px;
                transform: translateY(20px) scale(0.95);
            }

            .chatbot-window.open {
                transform: translateY(0) scale(1);
            }
        }

        /* PRINT STYLES */
        @media print {

            .sidebar,
            .action-fab,
            #chatbot,
            .menu-toggle,
            .search-container {
                display: none !important;
            }

            .main-content {
                margin: 0;
                padding: 0;
                height: auto;
                overflow: visible;
            }

            .recipe-view {
                display: block !important;
                page-break-after: always;
                margin: 0;
                padding: 2rem 0;
                animation: none;
            }

            body {
                height: auto;
                display: block;
                background: white;
            }

            .recipe-grid {
                display: block;
            }

            .ingredients-card {
                box-shadow: none;
                border: none;
                padding: 0;
                margin-bottom: 2rem;
            }

            .recipe-image-wrapper {
                height: 300px;
                border-radius: 0;
                margin-bottom: 2rem;
                box-shadow: none;
            }

            .recipe-title {
                font-size: 2.2rem;
                color: black;
            }

            .recipe-meta-row {
                border: none;
                padding: 0;
                box-shadow: none;
            }

            li::before,
            ol li::before {
                color: black !important;
                background: none !important;
                border: 1px solid black;
                width: 20px;
                height: 20px;
                line-height: 18px;
                font-size: 0.8rem;
            }
        }

        /* PROFESSIONAL SECTIONS */
        .pro-approach,
        .success-metrics {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #fff9f9;
            border-left: 4px solid var(--accent);
            border-radius: 4px;
        }

        .pro-approach h3,
        .success-metrics h3 {
            font-family: 'Playfair Display', serif;
            color: var(--primary);
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .pro-approach p,
        .success-metrics p {
            font-family: 'Inter', sans-serif;
            color: #555;
            line-height: 1.7;
            margin-bottom: 0;
        }

        .success-metrics {
            background: #f0fff4;
            border-left-color: #27ae60;
        }

        .success-metrics h3 {
            color: #2c3e50;
        }

        /* Pro Tip Highlight */
        .pro-tip {
            display: block;
            margin-top: 8px;
            padding: 8px 12px;
            background: #fff8e1;
            border-left: 3px solid #f1c40f;
            font-size: 0.9em;
            color: #7f8c8d;
            font-style: italic;
        }

        .pro-tip strong {
            color: #d35400;
            font-style: normal;
        }
    </style>
</head>

<body>

    <!-- Mobile Toggle -->
    <div class="menu-toggle" onclick="document.querySelector('.sidebar').classList.toggle('open')">
        <i class="fas fa-bars"></i>
    </div>

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h1>Aabaan's<br>Kitchen</h1>
            <p>Recipe Collection</p>
        </div>
        <div class="search-container">
            <input type="text" class="search-input" placeholder="Search recipes..." id="search-box">
        </div>
        <ul class="nav-list" id="nav-list">
            <!-- Items injected by JS -->
        </ul>
        <div class="sidebar-footer"
            style="padding: 20px; text-align: center; border-top: 1px solid rgba(0,0,0,0.05); margin-top: auto;">
            <a href="https://github.com/aabaan321" target="_blank" title="GitHub"
                style="color: #95a5a6; margin: 0 10px; font-size: 1.2rem;"><i class="fab fa-github"></i></a>
            <a href="https://instagram.com/aabaanrg73" target="_blank" title="Instagram"
                style="color: #95a5a6; margin: 0 10px; font-size: 1.2rem;"><i class="fab fa-instagram"></i></a>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main-content" id="main-content">
        <div id="welcome-view">
            <i class="fas fa-utensils welcome-icon"></i>
            <h2 style="font-family: 'Playfair Display'; font-size: 2.5rem; color: var(--primary);">Welcome to the
                Kitchen</h2>
            <p style="color: var(--text-light); max-width: 400px; margin: 1rem auto;">Select a recipe from the menu to
                begin your culinary journey.</p>
        </div>
    </main>

    <!-- ACTIONS -->
    <!-- Removed manual Edit button per request to reduce clutter -->

    <!-- PRINT BUTTON -->
    <a href="#" onclick="window.print();return false;" class="action-fab" title="Print to PDF"><i
            class="fas fa-print"></i></a>

    <!-- CHATBOT -->



    <script>
        const recipes = [

            // CHAPTER 1: Appetizers
            {
                id: 'buffalo-wings', cat: 'Ch 1: Appetizers', title: 'Buffalo Chicken Wings',
                img: 'Buffalo Chicken Wings',
                intro: 'The secret to legendary buffalo wings lies in three critical elements: bone-dry skin before coating, precise oil temperature for maximum crispiness, and the perfect sauce ratio that coats without making wings soggy. This technique produces wings with an audibly crispy exterior that shatters with each bite.',
                outcome: 'Perfect buffalo wings have a deep golden-brown, crispy exterior that audibly crunches when bitten. The sauce should glisten without pooling on the plate, and the meat should be juicy and easily pull away from the bone.',
                meta: ['15m Prep', '25m Cook', '4-6 Servings'],
                ing: [
                    '1 kg chicken wings, separated into flats (wingettes) and drumettes',
                    '1 cup all-purpose flour (provides the structure for the crust)',
                    '1 tsp paprika (adds color and subtle smokiness)',
                    '1 tsp garlic powder',
                    '1/2 tsp cayenne pepper (heat that builds gradually)',
                    '1 tsp chilli powder',
                    'Salt and black pepper to taste',
                    'Vegetable oil (peanut recommended for high heat stability)',
                    'Sauce: 1/2 cup hot sauce (Frank\'s RedHot is traditional)',
                    'Sauce: 3 tbsp unsalted butter (melted - creates emulsion and richness)',
                    'Sauce: 1/2 cup honey (balances heat with sweetness)'
                ],
                ins: [
                    '<strong>1. Prepare the Wings (The Foundation of Crispiness)</strong><br>Remove wings from packaging and pat them COMPLETELY dry with paper towels. This is the single most important stepâ€”any moisture will steam the wings instead of frying them. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Professional restaurants often dry wings overnight in the refrigerator (uncovered) for maximum skin tightness.</span>',
                    '<strong>2. Create the Seasoned Flour Coating</strong><br>In a large bowl, whisk together the flour, paprika, garlic powder, cayenne pepper, chilli powder, salt, and pepper. Add your dried wings to the flour mixture and toss vigorously. Let them rest on a wire rack for 10-15 minutes to hydrate the flour.',
                    '<strong>3. Heat the Oil (Critical Step)</strong><br>Heat oil in a heavy-bottomed pot to exactly 180Â°C (350Â°F). Use a thermometer. At this temp, the wings cook through while developing a golden crust.',
                    '<strong>4. Fry in Batches</strong><br>Carefully lower 5-6 wings into the oil. Do not overcrowd. Fry for 10-12 minutes until deep golden brown (Internal temp 74Â°C/165Â°F). Remove to a wire rack. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Listen for the soundâ€”when the aggressive bubbling subsides to a gentle sizzle, they are nearly done.</span>',
                    '<strong>5. The Signature Sauce</strong><br>Whisk together melted butter, hot sauce, and honey until emulsified and glossy. The butter helps the sauce cling.',
                    '<strong>6. Toss and Serve</strong><br>Immediately toss the hot wings in the sauce. The residual heat helps the sauce adhere. Serve immediately.'
                ]
            },
            {
                id: 'fried-shrimp', cat: 'Ch 1: Appetizers', title: 'Breaded Fried Shrimp',
                img: 'Breaded Fried Shrimp',
                intro: 'The difference between rubbery, greasy shrimp and succulent, crispy ones is speed and the "Standard Breading Procedure". We use Panko (Japanese breadcrumbs) for a jagged, airy texture that stays crispy longer than fine crumbs.',
                outcome: 'The shrimp should stand straight when held by the tail (if left on). The coating should be jagged and golden, not oily. The bite should be an audible "crunch" followed by the snap of perfectly cooked shrimp.',
                meta: ['20m Prep', '10m Cook', '4 Servings'],
                ing: [
                    '500g large shrimp (peeled and deveined, tails left on for handle)',
                    '1 cup all-purpose flour (the dry anchor)',
                    '2 large eggs, beaten with 1 tbsp water (the glue)',
                    '1.5 cups Panko breadcrumbs (the crunch)',
                    'Spices: Salt, black pepper, red chilli flakes, smoked paprika, garlic powder',
                    'Neutral oil for frying'
                ],
                ins: [
                    '<strong>1. The 3-Station Setup</strong><br>Set up three shallow bowls: 1) Flour mixed with spices. 2) Beaten eggs. 3) Panko breadcrumbs mixed with more spices. This "Standard Breading Procedure" ensures the coating never falls off.',
                    '<strong>2. Dry and Dredge</strong><br>Pat shrimp dry. Dust in flour, shake off excess. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Shake off almost ALL the flour; you only need a microscopic layer to hold the egg.</span>',
                    '<strong>3. Egg and Panko</strong><br>Dip in egg wash, then press firmly into Panko. Ensure the shrimp is fully buried in crumbs.',
                    '<strong>4. Flash Fry</strong><br>Heat oil to 175Â°C (350Â°F). Fry in small batches for only 2-3 minutes. Shrimp cook incredibly fast; the moment they curl and the crust is golden, pull them out.',
                    '<strong>5. Drain</strong><br>Drain on a wire rack or paper towel-lined plate to wick away excess oil immediately.'
                ]
            },
            {
                id: 'nuggets', cat: 'Ch 1: Appetizers', title: 'Homemade Chicken Nuggets',
                img: 'Homemade Chicken Nuggets',
                intro: 'Forget the drive-thru. Real nuggets are about texture contrast: a flavorful, sturdy crust protecting a steamy, tender interior. We use breast meat cut against the grain for tenderness.',
                outcome: 'Uniformly golden brown. The crust should not detach from the chicken. The interior should be moist and white, not stringy.',
                meta: ['20m Prep', '15m Cook', '4 Servings'],
                ing: [
                    '500g chicken breast, cut into 1-inch bite-sized chunks',
                    '1 cup all-purpose flour',
                    '2 large eggs, beaten',
                    '1 cup dry breadcrumbs or Panko (for texture)',
                    'Seasoning: Salt, pepper, paprika, garlic powder (be generous)'
                ],
                ins: [
                    '<strong>1. Season the Meat Directly</strong><br>Season the chicken chunks with salt and pepper BEFORE breading. This ensures the meat itself is tasty, not just the crust.',
                    '<strong>2. Standard Breading</strong><br>Coat in flour, dip in egg, roll in breadcrumbs. Press the crumbs on hard.',
                    '<strong>3. Shallow Fry Technique</strong><br>Heat 1 inch of oil in a skillet (you don\'t need a deep fryer). Heat to medium-high. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> If the oil isn\'t hot enough, the breading will soak it up like a sponge. Test with a crumb; it should sizzle immediately.</span>',
                    '<strong>4. Cook</strong><br>Fry 3-4 minutes per side. Do not constantly flip; let the crust set.'
                ]
            },
            {
                id: 'tenders', cat: 'Ch 1: Appetizers', title: 'Crispy Fried Chicken Tenders',
                img: 'Crispy Chicken Tenders',
                intro: 'The "Tender" is the filet mignon of the chicken. The secret here is a buttermilk marinade, which contains enzymes and acids that break down proteins for impossible tenderness, while creating a craggy surface for the flour to cling to.',
                outcome: 'The coating should be "craggy" and uneven (that\'s a good thing!), providing maximum surface area for crunch.',
                meta: ['4h Marinate', '12m Cook', '4 Servings'],
                ing: [
                    '500g chicken tenders (the tenderloin muscle)',
                    '2 cups buttermilk (acidic tenderizer)',
                    '1.5 cups all-purpose flour',
                    '1 tbsp cornstarch (adds shatter-crispiness)',
                    'Spices: Smoked paprika, salt, pepper, onion powder, garlic powder, red chilli powder'
                ],
                ins: [
                    '<strong>1. The Buttermilk Soak</strong><br>Marinate tenders in buttermilk for at least 30 minutes, ideally 4 hours. This tenderizes the meat profoundly.',
                    '<strong>2. The Spice Blend</strong><br>Whisk flour, cornstarch, and spices. The cornstarch inhibits gluten formation, making the crust crisp rather than tough.',
                    '<strong>3. The "Drip" Technique</strong><br>Lift chicken from buttermilk, let excess drip for a second, then bury in flour. Press down. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Drizzle a little extra buttermilk into the flour bowl and mix it with your fingers to create small dough clumps. These fry up into extra-crunchy bits.</span>',
                    '<strong>4. Deep Fry</strong><br>Fry at 175Â°C (350Â°F) for 5-7 minutes. Do not overload the fryer.'
                ]
            },
            {
                id: 'cheese-sticks', cat: 'Ch 1: Appetizers', title: 'Golden Cheese Sticks',
                img: 'Mozzarella Sticks',
                intro: 'The tragedy of homemade cheese sticks is "The Blowout"â€”when cheese leaks out before the shell cooks. The professional solution is the "Double Dip" and the "Deep Freeze".',
                outcome: 'A solid golden shell that holds its shape. When pulled apart, the cheese should stretch for feet without breaking (the "cheese pull").',
                meta: ['1h Freeze', '5m Cook', '4 Servings'],
                ing: [
                    '250g block of low-moisture mozzarella (not fresh mozzarella, it\'s too watery)',
                    '1 cup Italian-style breadcrumbs (pre-seasoned)',
                    '1/2 cup flour',
                    '2 large eggs, beaten',
                    'Oil for frying'
                ],
                ins: [
                    '<strong>1. Mise en Place</strong><br>Cut mozzarella into uniform sticks. Uniformity equals even cooking.',
                    '<strong>2. The Double Dip (Mandatory)</strong><br>Flour -> Egg -> Breadcrumbs. Then... BACK into Egg -> BACK into Breadcrumbs. This thick armor is the only thing standing between you and a cheese explosion.',
                    '<strong>3. The Deep Freeze</strong><br>Place breaded sticks on a tray and freeze for at least 1 hour. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> You are frying ice-cold cheese. This allows the shell to brown in the hot oil BEFORE the cheese completely liquefies and leaks.</span>',
                    '<strong>4. Flash Fry</strong><br>Hot oil (180Â°C). Fry fast (1-2 minutes). Remove the second they turn golden.'
                ]
            },
            {
                id: 'onion-rings', cat: 'Ch 1: Appetizers', title: 'Classic Onion Rings',
                img: 'Onion Rings',
                intro: 'Great onion rings require a batter that puffs up and stays crispy, not a heavy dough. We use baking powder for lift and buttermilk for tang. The contrast between the sweet, steamed onion and the savory, salty batter is key.',
                outcome: 'Puffy, golden-brown rings. The onion should bite through cleanly rather than pulling out of the batter in one long string (a sign of undercooking or tough membrane).',
                meta: ['15m Prep', '15m Cook', '4-6 Servings'],
                ing: [
                    '2 large sweet onions (Vidalia or Walla Walla)',
                    '1.5 cups all-purpose flour',
                    '1 cup buttermilk (or club soda for an airy, tempura-style ring)',
                    '1 large egg',
                    '1 tsp baking powder (chemical leavener for puffiness)',
                    '1 tsp salt',
                    'Oil for frying'
                ],
                ins: [
                    '<strong>1. Prep Onions</strong><br>Slice thick (1/2 inch). <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Peel the thin, papery membrane off the inside of each ring if you catch itâ€”this prevents the "onion pull" problem.</span>',
                    '<strong>2. The Batter</strong><br>Whisk flour, baking powder, and salt. Whisk in buttermilk and egg until just combined (lumps are okay).',
                    '<strong>3. The Dry-Wet Method</strong><br>Heat oil to 190Â°C (375Â°F). Dredge onion in PLAIN flour first (helps batter stick), then dip in batter.',
                    '<strong>4. Fry</strong><br>Drop into oil. Fry 2-3 minutes, flipping once. Drain on a wire rack to keep them crisp.'
                ]
            },
            {
                id: 'corn-soup', cat: 'Ch 1: Appetizers', title: 'Creamy Chicken Corn Soup',
                img: 'Chicken Corn Soup',
                intro: 'A classic comfort food that relies on the "Egg Ribbon" technique. This Chinese-style soup thickens with cornstarch and creamed corn, offering a silky texture broken up by strands of egg.',
                outcome: 'A glossy, slightly thickened broth. The egg ribbons should be delicate and floating, not clumped. The flavor is a balance of savory chicken and sweet corn.',
                meta: ['10m Prep', '25m Cook', '4 Servings'],
                ing: [
                    '2 chicken breasts, cooked and shredded (poached is best for softness)',
                    '1 tbsp butter',
                    '1 small onion, diced',
                    '2 cloves garlic, minced',
                    '4 cups high-quality chicken broth',
                    '1 can cream-style corn (provides the body)',
                    '1 can whole kernel corn (drained, provides texture)',
                    '1 egg, beaten well',
                    'Sesame oil (optional finish)',
                    'Fresh parsley or green onions'
                ],
                ins: [
                    '<strong>1. Build the Base</strong><br>SautÃ© onion and garlic in butter until soft and aromatic. This builds the flavor foundation.',
                    '<strong>2. Simmer</strong><br>Add broth, creamed corn, whole corn, and chicken. Simmer for 15 minutes to marry the flavors.',
                    '<strong>3. The Egg Drop (Technique)</strong><br>Turn off the heat. Stir the soup in a gentle, continuous circular motion to create a whirlpool. Slowly drizzle the beaten egg into the moving soup. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> The heat of the soup cooks the egg instantly into thin, silky ribbons. If you dump it in, you get scrambled eggs.</span>',
                    '<strong>4. Season</strong><br>Finish with salt, white pepper (for that authentic taste), and a drop of sesame oil.'
                ]
            },

            // CHAPTER 2: Beef & Lamb
            {
                id: 'wellington', cat: 'Ch 2: Beef & Lamb', title: 'Beef Wellington',
                img: 'Beef Wellington',
                intro: 'The Mount Everest of home cooking. Beef Wellington is a study in moisture management. The goal is a medium-rare tenderloin inside a crispy, flaky pastry shell, without the dreaded "soggy bottom". We achieve this with a barrier of crÃªpes and a bone-dry mushroom duxelles.',
                outcome: 'When sliced, the pastry should shatter. The cross-section should reveal distinct layers: golden pastry, green herbs/crÃªpe, dark mushroom duxelles, and a wall-to-wall pink center (medium-rare).',
                meta: ['1h Prep', '25m Cook', 'Special Occasion'],
                ing: [
                    '750g center-cut beef tenderloin (fillet mignon), trimmed of silverskin',
                    '500g puff pastry (all-butter is best), thawed but cold',
                    '400g mushrooms (chestnut or cremini), finely chopped',
                    '1 shallot and 2 cloves garlic, minced',
                    'Fresh thyme leaves (1 tbsp)',
                    '12 slices of Prosciutto di Parma (adds saltiness and a moisture barrier)',
                    'Dijon mustard (for brushing the beef)',
                    'Egg wash: 2 egg yolks beaten with 1 tsp water',
                    'Salt and freshly ground black pepper'
                ],
                ins: [
                    '<strong>1. The Sear</strong><br>Season beef heavily. Sear in a screaming hot pan with oil for 1 minute per side until brown. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Do not cook it; just color it. Remove and brush immediately with Dijon mustard while hot (pores are open). Let it cool completely.</span>',
                    '<strong>2. The Duxelles (Moisture Control)</strong><br>Cook mushrooms, shallots, garlic, and thyme in a dry pan. Cook until ALL moisture has evaporated and the mixture looks like a dark paste. This prevents a soggy pastry.',
                    '<strong>3. The Assembly Layer</strong><br>Lay out a large sheet of plastic wrap. Arrange prosciutto slices in a rectangle. Spread the mushroom duxelles thinly over the ham. Place the cooled beef in the center.',
                    '<strong>4. The Tight Roll</strong><br>Use the plastic wrap to roll the prosciutto/mushroom mix tightly around the beef. Twist the ends like a candy wrapper to compress it into a log. Chill for 15 mins to set shape.',
                    '<strong>5. Pastry Encasement</strong><br>Roll out puff pastry. Unwrap the beef log and place it in the center. Brush pastry edges with egg wash. Roll up tight, seal seams, and trim excess. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Chill the entire Wellington again for 15 mins. Cold pastry hits hot oven = maximum puff.</span>',
                    '<strong>6. Bake</strong><br>Brush with egg wash. Score decorative patterns. Bake at 200Â°C (400Â°F) for 20-25 mins until golden. Internal temp should be 52Â°C (125Â°F) for medium-rare. Rest 10 mins before slicing.'
                ]
            },
            {
                id: 'lamb-rack', cat: 'Ch 2: Beef & Lamb', title: 'Pistachio-Crusted Rack of Lamb',
                img: 'Rack of Lamb',
                intro: 'A rack of lamb is elegant, but a pistachio crust adds texture and a visual "wow" factor. We sear the meat first to render fat, then roast it gently. The mustard acts as the glue for the crust.',
                outcome: 'The meat should be blushing pink (medium-rare) with a vibrant green, crunchy crust that stays attached when sliced.',
                meta: ['20m Prep', '30m Cook', '4 Servings'],
                ing: [
                    '2 racks of lamb (frenched - bones scraped clean)',
                    'Salt and pepper',
                    '2 tbsp Dijon mustard (the glue)',
                    'Crust: 1/2 cup shelled pistachios (unsalted)',
                    'Crust: 1/2 cup Panko breadcrumbs',
                    'Crust: 2 cloves garlic, fresh parsley, 2 tbsp olive oil'
                ],
                ins: [
                    '<strong>1. Fat Rendering</strong><br>Score the fat cap in a diamond pattern. Season well. Sear fat-side down in a cold pan, bringing heat up slowly to render the fat (5-8 mins). Flip and sear the bottom briefly.',
                    '<strong>2. The Glue</strong><br>Remove lamb from heat. Brush the rendered fat side generously with Dijon mustard.',
                    '<strong>3. The Crust</strong><br>Pulse pistachios, breadcrumbs, herbs, and oil in a processor until it looks like wet sand. Press this mixture firmly onto the mustard-slathered lamb.',
                    '<strong>4. Roast</strong><br>Roast at 200Â°C (400Â°F) for 15-20 mins. Pull at 52Â°C (125Â°F) internal temp.',
                    '<strong>5. Rest</strong><br>Rest for 10 minutes. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Carver between the bones. Do not saw back and forth; use long, clean strokes to keep the crust intact.</span>'
                ]
            },
            {
                id: 'lamb-chops', cat: 'Ch 2: Beef & Lamb', title: 'Pan-Seared Lamb Chops',
                img: 'Lamb Chops',
                intro: 'Lamb loin chops are like mini T-bone steaks. They cook fast and love garlic and rosemary. The key is the "Butter Baste" (ArrosÃ©) technique at the end to cook the inside gently while flavoring the crust.',
                outcome: 'Deep brown crust, juicy pink center. The fat strip on the edge should be rendered and crisp, not chewy.',
                meta: ['35m Prep', '10m Cook', '2-4 Servings'],
                ing: [
                    '8 lamb loin chops (at least 1 inch thick)',
                    'Salt and freshly ground black pepper',
                    '2 cloves garlic, smashed but whole',
                    'Fresh rosemary and thyme sprigs',
                    '3 tbsp unsalted butter (cold)',
                    '1 tbsp olive oil'
                ],
                ins: [
                    '<strong>1. Tempering</strong><br>Take chops out of fridge 30 mins before cooking. Cold meat cooks unevenly.',
                    '<strong>2. The Sear</strong><br>Get skillet smoking hot with oil. Lay chops in. Press down. Sear 3-4 mins undisturbed until a hard crust forms.',
                    '<strong>3. Render the Edge</strong><br>Hold chops with tongs and press the fatty edge into the pan to crisp it up.',
                    '<strong>4. The Butter Baste (ArrosÃ©)</strong><br>Flip chops. Toss in butter, garlic, and herbs. Tilt the pan so butter pools. Spoon foaming butter over the meat repeatedly for 2-3 mins. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> This basting cooks the meat from the top down with hot, flavored fat.</span>'
                ]
            },
            {
                id: 'steak', cat: 'Ch 2: Beef & Lamb', title: 'The Perfect Pan-Seared Steak',
                img: 'Pan Seared Steak',
                intro: 'You don\'t need a grill for steakhouse quality. You need a cast-iron skillet and the courage to use high heat. We start with oil to sear, then finish with butter to flavor.',
                outcome: 'Wall-to-wall medium-rare (no grey band). A dark mahogany crust that is salty and savory.',
                meta: ['5m Prep', '10m Cook', '2 Servings'],
                ing: [
                    '2 thick-cut Ribeye or New York Strip steaks (1.5 inches thick)',
                    'Kosher salt (large grains adhere better)',
                    'Coarse black pepper',
                    '2 tbsp high-smoke point oil (Avocado or Grapeseed)',
                    '3 tbsp unsalted butter',
                    '3 cloves garlic, crushed',
                    'Fresh thyme or rosemary'
                ],
                ins: [
                    '<strong>1. Dry and Season</strong><br>Pat steak BONE DRY. Moisture is the enemy of the crust. Season aggressively with salt and pepper on all sides.',
                    '<strong>2. Smoke Point</strong><br>Heat cast-iron until it literally smokes. Add oil. Lay steak away from you to avoid splash.',
                    '<strong>3. The Crust</strong><br>Flip every minute (method: frequent flipping cooks more evenly than once). aim for a deep brown char.',
                    '<strong>4. Butter Baste</strong><br>When steak is 10 degrees from target temp, kill the heat. Add butter/herbs. Baste for the final minute.',
                    '<strong>5. The Rest</strong><br>Rest for 10 minutes on a warm plate. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Cutting early spills the juices. Resting lets the fibers relax and reabsorb liquid.</span>'
                ]
            },
            {
                id: 'burger', cat: 'Ch 2: Beef & Lamb', title: 'Ultimate Beef Smashed Burger',
                img: 'Smashed Burger',
                intro: 'The "Smash Burger" uses physics to create flavor. By smashing beef onto a hot surface, we maximize the Maillard reaction (browning), creating a lacey, crispy crust that a thick patty can never achieve.',
                outcome: 'A jagged, crispy, dark brown crust. The cheese should be fully melted into the crevices. The bun must be toasted to hold the juices.',
                meta: ['10m Prep', '10m Cook', '4 Servings'],
                ing: [
                    '500g ground beef (80/20 fat ratio is mandatory; lean beef will be dry)',
                    '4 slices American cheese (melts the best)',
                    '4 Brioche buns (soft but sturdy)',
                    'Salt and pepper',
                    'Toppings: Pickles, diced onions, shredded lettuce',
                    'Sauce: Spicy Burger Sauce (see Chapter 6)'
                ],
                ins: [
                    '<strong>1. Prep Balls</strong><br>Divide beef into 4 loose balls. Do not pack them tight; we want air pockets.',
                    '<strong>2. Toast Buns</strong><br>This seals the surface so sauce doesn\'t make it soggy. Do this first.',
                    '<strong>3. The Smash</strong><br>Place beef balls on screaming hot griddle. Using a heavy spatula (and a second utensil to press down), smash the ball FLAT until thin. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Use parchment paper between spatula and meat to prevent sticking.</span>',
                    '<strong>4. Crust and Melt</strong><br>Season. Cook 2 mins until edges are dark brown. Scrape hard to keep crust on the meat. Flip. Immediately add cheese.',
                    '<strong>5. Assemble</strong><br>Sauce bottom bun. Meat. Pickles. Top bun. Eat instantly.'
                ]
            },
            {
                id: 'lasagna', cat: 'Ch 2: Beef & Lamb', title: 'Hearty Meat Lasagna',
                img: 'Lasagna',
                intro: 'Lasagna is about structural integrity and flavor balance. We use a rich Bolognese (meat sauce) and a creamy cheese Binder. The key is letting it rest so it slices like a cake, not a soup.',
                outcome: 'Distinct layers defined by pasta. The top should be blistered cheese. It should hold its square shape on the plate.',
                meta: ['40m Prep', '1h Cook', '8 Servings'],
                ing: [
                    'Meat Sauce: 500g ground beef, 1 onion, 2 cloves garlic, 1 jar high-quality marinara, 1 tsp Italian herbs',
                    'Cheese Filling: 400g ricotta (drained), 1 egg (binder), 1/2 cup parmesan, fresh parsley, pinch of nutmeg',
                    'Pasta: Oven-ready lasagna sheets (or boiled noodles)',
                    '2 cups shredded mozzarella cheese'
                ],
                ins: [
                    '<strong>1. The Sauce</strong><br>Brown beef heavily. Add veg, cook down. Add marinara. Simmer 20 mins to thicken. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> A watery sauce makes a watery lasagna. Reduce it well.</span>',
                    '<strong>2. The Cheese Binder</strong><br>Mix ricotta, egg, parmesan, and herbs. The egg ensures this layer sets firmly.',
                    '<strong>3. The Architecture</strong><br>Small spoon of sauce on bottom (prevents sticking). Layer: Noodles -> Cheese Mix -> Meat Sauce -> Mozzarella. Repeat 3-4 times.',
                    '<strong>4. Bake</strong><br>Cover with foil (prevents burning). Bake 25 mins at 190Â°C. Uncover. Bake 20 mins until bubbly.',
                    '<strong>5. The Patience Test</strong><br>Let it rest for at least 15-20 minutes. If you cut it hot, it collapses. If you wait, it sets perfect squares.'
                ]
            },

            // CHAPTER 3: Chicken
            {
                id: 'butter-chicken', cat: 'Ch 3: Chicken', title: 'Butter Chicken (Fusion)',
                img: 'Butter Chicken',
                intro: 'This is not the overly sweet, bright red restaurant version. This is the authentic "Murgh Makhani" with a smoky undertone. The secret is grilling the chicken first to get a char (mimicking the Tandoor) before simmering it in the silky, tomato-fenugreek sauce.',
                outcome: 'A velvet-smooth, orange-gold sauce that clings to the spoon. The chicken should have charred edges but remain juicy. The smoky aroma of Kasuri Methi (dried fenugreek) should be prominent.',
                meta: ['4h Marinate', '30m Cook', '4-6 Servings'],
                ing: [
                    '750g boneless, skinless chicken thighs (never breast; thighs stay juicy)',
                    'Marinade: 1 cup yogurt, 2 tbsp ginger-garlic paste, 1 tbsp lemon juice, spices',
                    'Spices: 2 tsp garam masala, 1 tsp turmeric, 1 tsp kashmiri chilli (color), salt',
                    'Gravy: 500g fresh tomatoes (blended), 2 tbsp butter, 1 onion (finely chopped)',
                    'Gravy Finish: 1/2 cup heavy cream, 1 tbsp sugar, 1 tbsp dried fenugreek leaves (Kasuri Methi)'
                ],
                ins: [
                    '<strong>1. The Marination</strong><br>Mix chicken with yogurt, lemon, and spices. The lactic acid and lemon tenderize the meat. Marinate 4 hours to overnight.',
                    '<strong>2. The Char (Tandoor Hack)</strong><br>Thread chicken on skewers. Grill on high heat or broil in oven until blackened in spots. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Do not cook it 100% through; it finishes in the sauce. The char adds the essential smoky flavor.</span>',
                    '<strong>3. The Base</strong><br>SautÃ© onions in butter until golden. Add ginger-garlic paste. Add fresh tomato puree and cook down until oil separates from the masala (bhunoo).',
                    '<strong>4. The Makhani (Buttery) Finish</strong><br>Add the charred chicken. Stir in cream and sugar. Crush fenugreek leaves between palms (releases oils) and sprinkle on top. Simmer 5 mins.'
                ]
            },
            {
                id: 'fried-chicken', cat: 'Ch 3: Chicken', title: 'Classic Fried Chicken',
                img: 'Fried Chicken',
                intro: 'Southern-style fried chicken relies on a brine for moisture and a seasoned flour dredge for crust. We use the "6-10-14" method: 6 mins frying, 10 mins resting, 14 spices.',
                outcome: 'A dark golden brown crust that shatters. The meat closest to the bone should be fully cooked but dripping with clear juices.',
                meta: ['1h Brine', '25m Cook', '4 Servings'],
                ing: [
                    '1 whole chicken (cut into 8 pieces: 2 drum, 2 thigh, 2 breast, 2 wing)',
                    'Brine: 4 cups buttermilk, 2 tbsp salt, 1 tbsp pepper, garlic/onion powder',
                    'Dredge: 2 cups flour, 1/4 cup cornstarch (crispness)',
                    'Spices: Paprika, garlic powder, onion powder, salt, pepper, dried herbs',
                    'Peanut oil or vegetable shortening for frying'
                ],
                ins: [
                    '<strong>1. The Brine</strong><br>Submerge chicken in seasoned buttermilk for 1-4 hours. This seasons the meat to the bone.',
                    '<strong>2. The Dredge</strong><br>Lift chicken, shake off excess liquid (but leave it damp). Press HARD into the flour mix. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Let the breaded chicken sit on a rack for 15 mins. The flour will absorb the moisture and become "sticky". This prevents the coating from falling off in the oil.</span>',
                    '<strong>3. Temperature Control</strong><br>Heat oil to 165Â°C (325Â°F) - lower than wings because bone-in pieces take longer to cook.',
                    '<strong>4. The Fry</strong><br>Fry dark meat (legs/thighs) for 12-14 mins. Fry white meat (breasts/wings) for 10-12 mins. Flip once.'
                ]
            },
            {
                id: 'tandoori', cat: 'Ch 3: Chicken', title: 'Tandoori Fried Chicken',
                img: 'Tandoori Chicken',
                intro: 'A hybrid masterpiece. All the spices of India meets the crunch of the American South. The yogurt marinade ensures the chicken is tangy and tender, while the spiced flour creates a crust that bursts with flavor.',
                outcome: 'A vibrant red-orange crust. The flavor profile is explosive: cumin, coriander, and chilli hits first, followed by the sour tang of the yogurt marinade.',
                meta: ['4h Marinate', '20m Cook', '4 Servings'],
                ing: [
                    '1 kg bone-in chicken pieces (scored deeply to let marinade penetrate)',
                    'Marinade: 1 cup yogurt, 3 tbsp Tandoori Masala, 2 tbsp ginger-garlic, lemon juice',
                    'Coating: 2 cups flour, 1 tbsp cornstarch, 1 tsp salt, 1 tsp garam masala',
                    'Oil for deep frying'
                ],
                ins: [
                    '<strong>1. Deep Scores</strong><br>Make 2-3 deep slashes in the thickest part of each piece. Rub the marinade into these cuts.',
                    '<strong>2. The Yogurt Barrier</strong><br>Unlike buttermilk, yogurt is thick. When dredging, leave a visible layer of yogurt on the chicken. It mixes with the flour to create a thicker, crunchier "batter-like" crust.',
                    '<strong>3. Fry</strong><br>Fry at 170Â°C (340Â°F). The yogurt sugars can burn fast, so manage the heat carefully. Rotate frequently.'
                ]
            },
            {
                id: 'parm', cat: 'Ch 3: Chicken', title: 'Classic Chicken Parmesan',
                img: 'Chicken Parmesan',
                intro: 'Chicken Parm is often ruined by sogginess. Our professional approach builds it structurally: A crispy cutlet that STAYS crispy even under sauce, by using a "reservation" of sauce and high-heat broiling.',
                outcome: 'The breading under the cheese should still maximize crunch. The cheese should be spotted brown (leopard spots).',
                meta: ['20m Prep', '25m Cook', '4 Servings'],
                ing: [
                    '4 chicken breasts (pounded thin to 1/2 inch)',
                    'Breading: Flour -> Egg -> Panko/Parmesan Mix',
                    '1.5 cups high-quality Marinara (thick, not watery)',
                    '200g Low-Moisture Mozzarella (shredded)',
                    'Fresh basil for finish'
                ],
                ins: [
                    '<strong>1. The Pound</strong><br>Pound chicken even. Season well.',
                    '<strong>2. The Crust</strong><br>Bread with Panko mixed with grated Parm. Fry in shallow oil until crispy and golden. Drain well.',
                    '<strong>3. The "Anti-Sog" Assembly</strong><br>Place cutlets on baking sheet. Spoon a SMALL amount of sauce in the center (leave edges dry). Pile cheese high. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Serve extra sauce on the side or under the pasta, not drowning the chicken.</span>',
                    '<strong>4. The Broil</strong><br>Bake/Broil at high heat just until cheese melts and bubbles. Finish with fresh basil.'
                ]
            },
            {
                id: 'chick-burger', cat: 'Ch 3: Chicken', title: 'The Fried Chicken Burger',
                img: 'Chicken Burger',
                intro: 'The ultimate sandwich. A boneless thigh (never breast) marinated, double-dredged for maximum cragginess, and served on a soft brioche that yields to the crunch.',
                outcome: 'The sandwich needs to hold together. The crunch should be audible across the room. The ratio of bun-to-meat-to-sauce must be balanced.',
                meta: ['1h Brine', '15m Cook', '6 Servings'],
                ing: [
                    '6 boneless, skinless chicken thighs (trimmed)',
                    'Brine: Buttermilk + Pickle Juice (secret weapon)',
                    'Dredge: Flour + Cornstarch + Paprika/Garlic/Onion/Pepper',
                    'Brioche Buns (toasted with butter)',
                    'Pickles, Lettuce, Sauce (See Ch 6)'
                ],
                ins: [
                    '<strong>1. Flatten</strong><br>Lightly pound thighs so they cook evenly and fit the bun.',
                    '<strong>2. The Crag</strong><br>Dredge: Buttermilk -> Flour -> Buttermilk -> Flour. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Press the flour in HARD. You want loose bits of dough hanging offâ€”these become the crispy "cornflakes" later.</span>',
                    '<strong>3. Fry</strong><br>Fry 175Â°C (350Â°F) for 6-8 mins. Thighs are forgiving; they won\'t dry out if you go a minute over.',
                    '<strong>4. Build</strong><br>Toast bun (mandatory). Sauce bottom. Chicken. Slaw/Lettuce. Pickles. Sauce top. Cap it.'
                ]
            },

            // CHAPTER 4: Seafood & Pasta
            {
                id: 'salmon', cat: 'Ch 4: Seafood & Pasta', title: 'Perfect Crispy Skin Salmon',
                img: 'Crispy Skin Salmon',
                intro: 'Most home cooks fear fish skin, so they discard the tastiest, healthiest part. The professional secret is "The Press". You must physically hold the fish down when it hits the pan to prevent curling, ensuring 100% skin contact for glass-like crispiness.',
                outcome: 'Skin that sounds like a cracker when tapped. Flesh that is translucent in the center (medium) and flakes in large petals.',
                meta: ['5m Prep', '10m Cook', '2 Servings'],
                ing: [
                    '2 salmon fillets (170g each), center-cut, skin-on',
                    '1 tbsp olive oil (not butter, butter burns before the skin crisps)',
                    'Coarse salt (Kosher or Maldon) and black pepper',
                    'Lemon wedges (acid cuts the fat)'
                ],
                ins: [
                    '<strong>1. The Scrape</strong><br>Use a knife to scrape moisture off the skin. Then pat bone dry. Moisture = Steam = Soggy Skin.',
                    '<strong>2. Cold Pan Start (Optional Hack)</strong><br>For beginners: Place fish skin-down in a COLD non-stick pan. Turn heat to medium-high. The fat renders slowly as the pan heats, guaranteeing crispiness.',
                    '<strong>3. Hot Pan Method (Classic)</strong><br>Heat oil until shimmering. Place fish skin-down. IMMEDIATELY press firmly with a spatula for 10 seconds. This stops the skin from contracting and curling.',
                    '<strong>4. The 90% Rule</strong><br>Cook 90% of the way on the skin side (5-6 mins). Watch the color change up the side of the fillet. Flip only for the final 30 seconds to kiss the top.'
                ]
            },
            {
                id: 'garlic-shrimp', cat: 'Ch 4: Seafood & Pasta', title: 'Classic Garlic Shrimp',
                img: 'Garlic Shrimp',
                intro: 'This is an exercise in heat management. Garlic burns in seconds. Shrimp turns to rubber in minutes. We use a "Cold Oil Infusion" start or separate the cooking times to ensure sweet, soft garlic and snappy shrimp.',
                outcome: 'Shrimp should snap, not chew. The sauce should be an emulsion of wine/lemon/butter, not separated oil.',
                meta: ['10m Prep', '10m Cook', '4 Servings'],
                ing: [
                    '500g large shrimp (peeled, deveined)',
                    '4 tbsp butter (cold, cubed)',
                    '4 tbsp olive oil',
                    '8 cloves garlic (sliced thin, not minced, for sweeter flavor)',
                    '1/2 cup chicken broth or white wine',
                    'Juice of 1 lemon'
                ],
                ins: [
                    '<strong>1. Scent the Oil</strong><br>Heat olive oil and garlic slices over LOW heat. Let garlic sizzle gently until golden. Remove garlic chips and save for garnish (prevents burning).',
                    '<strong>2. High Heat Sear</strong><br>Crank heat to high. Sear shrimp in the garlic oil. 1 min per side. Remove shrimp.',
                    '<strong>3. Pan Sauce</strong><br>Deglaze with broth/wine. Reduce by half. Turn off heat. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Whisk in the COLD cubed butter. This creates a creamy emulsion (Monte au Beurre).</span>',
                    '<strong>4. Combine</strong><br>Toss shrimp and garlic chips back in. Finish with lemon.'
                ]
            },
            {
                id: 'alfredo', cat: 'Ch 4: Seafood & Pasta', title: 'Creamy Alfredo White Sauce Pasta',
                img: 'Fettuccine Alfredo',
                intro: 'Authentic Roman Alfredo is just butter and Parmigiano. The American version adds cream. We do a hybrid: using starchy pasta water to emulsify the heavy cream and cheese into a sauce that coats the noodles rather than sliding off.',
                outcome: 'Noodles coated in a thick, ivory glaze. No pools of cream at the bottom of the bowl.',
                meta: ['5m Prep', '15m Cook', '4 Servings'],
                ing: [
                    '450g fettuccine (bronze-die cut holds sauce best)',
                    '1/2 cup butter',
                    '1.5 cups heavy cream (don\'t use milk, it splits)',
                    '2 cups Parmigiano-Reggiano (freshly grated is non-negotiable; pre-grated has anti-caking agents)',
                    'Nutmeg (freshly grated)'
                ],
                ins: [
                    '<strong>1. Water is an Ingredient</strong><br>Boil pasta in salted water. Reserve 1 cup of starchy water before draining.',
                    '<strong>2. The Simmer</strong><br>Melt butter. Add cream. Simmer 5 mins to reduce and thicken slightly. Add garlic if you must (it\'s not traditional, but tasty).',
                    '<strong>3. The Marriage</strong><br>Turn heat to LOW. Add cooked pasta to the sauce. Sprinkle cheese in handfuls, tossing constantly with tongs.',
                    '<strong>4. Emulsify</strong><br>Splash in pasta water as needed. The starch glues the oil and water together. Finish with nutmeg.'
                ]
            },
            {
                id: 'risotto', cat: 'Ch 4: Seafood & Pasta', title: 'Rich & Creamy Tomato Risotto',
                img: 'Tomato Risotto',
                intro: 'Risotto is not a rice dish; it is a technique. We irritate the rice grains by constant agitation to release amylopectin (starch), creating a creamy sauce without adding cream. The "Mantecatura" (final beating) is the most critical step.',
                outcome: 'The "All\'onda" wave: When you tilt the plate, the risotto should ripple effectively like a slow lava flow, not sit in a stiff mound.',
                meta: ['10m Prep', '35m Cook', '4 Servings'],
                ing: [
                    '1.5 cups Arborio or Carnaroli rice (essential for starch)',
                    '6 cups broth (kept simmering in a separate pot)',
                    '1/2 cup white wine (dry)',
                    '1 cup crushed San Marzano tomatoes',
                    'Finish: 2 tbsp COLD butter, 1/2 cup Parmesan'
                ],
                ins: [
                    '<strong>1. Tostatura (Toasting)</strong><br>SautÃ© shallots in oil. Add rice. Cook 2 mins until grains are hot and translucent at edges. This protects the grain integrity.',
                    '<strong>2. Deglaze</strong><br>Add wine. Let it evaporate completely (smell the alcohol cook off).',
                    '<strong>3. The Ladle Work</strong><br>Add hot broth one ladle at a time. Stir constantly. Wait until liquid is absorbed before adding next. This massage releases the starch.',
                    '<strong>4. Mantecatura (The Magic)</strong><br>When rice is al dente, remove from heat. Rest 1 min. Add COLD butter and cheese. Beat the risotto vigorously with a wooden spoon for 2 mins. This incorporates air and emulsifies the fat for ultimate creaminess.'
                ]
            },

            // CHAPTER 5: Pizzas, Tacos & Sides
            {
                id: 'margherita', cat: 'Ch 5: Pizzas & Sides', title: 'Italian-Style Margherita Pizza',
                img: 'Margherita Pizza',
                intro: 'Neapolitan pizza is a balance of three colors: Red (tomato), White (mozzarella), and Green (basil). The secret is high heat to char the crust while keeping the center tender (soupy).',
                outcome: 'A "leopard-spotted" crust (char bubbles). The cheese should be melted but distinct puddles, not a blanket. The center should be soft.',
                meta: ['15m Prep', '10-15m Cook', '1 Pizza'],
                ing: [
                    '1 ball of pizza dough (fermented 24h is best)',
                    'San Marzano tomatoes (crushed by hand, seasoned with salt only)',
                    'Fresh Mozzarella di Bufala or Fior di Latte (torn, not grated)',
                    'Fresh basil leaves',
                    'Extra Virgin Olive Oil'
                ],
                ins: [
                    '<strong>1. The Heat Strategy</strong><br>Preheat oven to MAX (250Â°C+). If you have a pizza stone, heat it for 1 hour. No stone? Flip a baking sheet upside down.',
                    '<strong>2. The Stretch</strong><br>Push air from center to rim (cornicione). Do not use a rolling pin (it crushes air pockets).',
                    '<strong>3. Less is More</strong><br>Spread sauce thinly. Scatter cheese. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Too much sauce triggers a "cheese slide". Keep it light.</span>',
                    '<strong>4. The Bake</strong><br>Bake 8-10 mins. Broil for the last 2 mins to char the crust spots.',
                    '<strong>5. Finish</strong><br>Add fresh basil AFTER baking (or right at the end) so it doesn\'t burn. Drizzle with oil.'
                ]
            },
            {
                id: 'pepperoni', cat: 'Ch 5: Pizzas & Sides', title: 'Classic Pepperoni Pizza',
                img: 'Pepperoni Pizza',
                intro: 'The "NY Style" slice. We want a crust that folds without cracking and pepperoni that cups up ("ronis") due to the heat.',
                outcome: 'A golden, rigid bottom crust. Pepperoni should have crispy edges and a pool of oil in the center.',
                meta: ['10m Prep', '12-15m Cook', '1 Pizza'],
                ing: [
                    '1 ball of pizza dough',
                    'Cooked Marinara (thicker than Neapolitan style)',
                    'Low-Moisture Mozzarella (shredded, for the "cheese pull")',
                    'Pepperoni slices (natural casing curls best)',
                    'Dried Oregano'
                ],
                ins: [
                    '<strong>1. The Base</strong><br>Stretch dough. Place on parchment (easier transfer).',
                    '<strong>2. Layering</strong><br>Sauce -> Cheese (edge to edge) -> Pepperoni (plenty of it).',
                    '<strong>3. Bake</strong><br>Bake at 250Â°C (475Â°F) on a hot surface/stone. Rotate halfway for even browning.',
                    '<strong>4. The Rest</strong><br>Let it sit 2 mins on a wire rack. This prevents the steam from making the bottom soggy.'
                ]
            },
            {
                id: 'tacos', cat: 'Ch 5: Pizzas & Sides', title: 'Chicken Tacos',
                img: 'Chicken Tacos',
                intro: 'A taco is a delivery system for contrast: Hot meat, cold salsa, creamy guac, corn tortilla scent. Everything must be fresh.',
                outcome: 'The tortilla should be pliable and warm, not cracking. The filling should be wet enough to flavor the bite but not drip excessively.',
                meta: ['25m Prep', '20m Cook', '4 Servings'],
                ing: [
                    'Chicken: Thighs rubbed with cumin, coriander, lime, ancho chilli',
                    'Pico de Gallo: Riped tomatoes, white onion, cilantro, lime juice (marinated 15 mins)',
                    'Guacamole: Avocado, salt, lime (keep it simple)',
                    'Tortillas: Corn (authentic) or Flour (Tex-Mex)'
                ],
                ins: [
                    '<strong>1. The Sear + Shred</strong><br>Sear chicken hard. Cook through. Shred with two forks. Toss the meat back in the pan juices.',
                    '<strong>2. Tortilla Maintenance</strong><br>NEVER serve cold tortillas. Toast them in a dry pan until charred spots appear and they become pliable. Keep warm in a cloth.',
                    '<strong>3. Assembly</strong><br>Meat first. Guac (glue). Pico on top. Fresh cilantro.',
                    '<strong>4. The Lime</strong><br>Squeeze fresh lime right before biting.'
                ]
            },
            {
                id: 'mash', cat: 'Ch 5: Pizzas & Sides', title: 'Fluffy Classic Mashed Potatoes',
                img: 'Mashed Potatoes',
                intro: 'Gluey potatoes are caused by overworked starch and water retention. We solve this by "Drying" the potatoes after boiling and using warm dairy.',
                outcome: 'Cloud-like texture. No lumps. Buttery aroma.',
                meta: ['10m Prep', '20m Cook', '6 Servings'],
                ing: [
                    '1 kg Yukon Gold (creamy) or Russet (fluffy) potatoes',
                    '1/2 cup heavy cream (warmed)',
                    '1/2 cup butter (room temp)',
                    'Salt and white pepper'
                ],
                ins: [
                    '<strong>1. The Boil</strong><br>Start in COLD salted water. Bring to boil. Cook until knife slides off easily.',
                    '<strong>2. The Dry (Critical)</strong><br>Drain water. Put potatoes BACK in the hot pot. Cook on low heat for 1 minute to evaporate steam. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Wet potatoes = watery mash that requires too much cream to fix.</span>',
                    '<strong>3. The Mash</strong><br>Use a Ricer or Food Mill for restaurant perfection. A hand masher is okay, but never a food processor (makes glue).',
                    '<strong>4. The Fold</strong><br>Fold in butter. Then stream in WARM cream. Do not whip perfectly smooth; stop while it\'s fluffy.'
                ]
            },
            {
                id: 'naan', cat: 'Ch 5: Pizzas & Sides', title: 'Soft Garlic Naan',
                img: 'Garlic Naan',
                intro: 'A Tandoor oven hits 900Â°F. Your skillet doesn\'t. We mimic the blistered texture by using high heat cast-iron and a yogurt-enriched dough that remains soft even when charred.',
                outcome: 'Large air bubbles with dark char spots. Soft and pliable, not cracker-like.',
                meta: ['1h Rise', '15m Cook', '8 Naan'],
                ing: [
                    '2.5 cups flour',
                    '1 tsp instant yeast + 1 tsp sugar',
                    '1/4 cup yogurt (softener)',
                    'Water + Oil',
                    'Garlic Butter: Melted butter + minced garlic + cilantro'
                ],
                ins: [
                    '<strong>1. The Dough</strong><br>Knead until smooth. Let rise 1 hour until doubled. The yogurt tenderizes the gluten.',
                    '<strong>2. The Roll</strong><br>Divide into balls. Roll thin (1/4 inch).',
                    '<strong>3. The Skillet Method</strong><br>Get cast-iron smoking hot. Lay dough in. Wait for bubbles to swell up like balloons (1 min). Flip. Char the other side.',
                    '<strong>4. The Finish</strong><br>Brush IMMEDIATELY with garlic butter while hot. Stack them in a towel to steam each other soft.'
                ]
            },
            {
                id: 'fried-rice', cat: 'Ch 5: Pizzas & Sides', title: 'Simple & Delicious Fried Rice',
                img: 'Fried Rice',
                intro: 'The #1 Rule of Fried Rice: Use OLD rice. Fresh rice turns to mush. Day-old, refrigerated rice has dried-out grains that separate beautifully when seared.',
                outcome: 'Individual grains coated in oil/sauce, not clumps. A savory, slightly smoky aroma (Wok Hei) if your pan is hot enough.',
                meta: ['10m Prep', '10m Cook', '4 Servings'],
                ing: [
                    '4 cups Day-Old cooked rice (cold)',
                    '3 tbsp neutral oil',
                    '2 eggs (beaten)',
                    'Veg: Onion, peas, carrots, diced small',
                    'Aromatics: Garlic, ginger, scallions',
                    'Seasoning: Soy sauce, sesame oil, white pepper, tiny splash of vinegar'
                ],
                ins: [
                    '<strong>1. Egg First</strong><br>Scramble eggs in oil. Remove. This keeps them yellow and distinct.',
                    '<strong>2. Aromatics</strong><br>SautÃ© onion/carrots/garlic until soft.',
                    '<strong>3. Rice Fry</strong><br>Crank heat. Add rice. Break up clumps. Let it sit for 30 seconds to get crispy before tossing. Repeat.',
                    '<strong>4. Season</strong><br>Add soy sauce around the rim of the pan (sears the soy). Toss in eggs and peas.',
                    '<strong>5. Finish</strong><br>Off heat, stir in sesame oil and scallions.'
                ]
            },

            // CHAPTER 6: Sauces
            {
                id: 'marinara', cat: 'Ch 6: Sauces', title: 'Classic Marinara Sauce',
                img: 'Marinara Sauce',
                intro: 'A good Marinara is not just "tomato sauce". It is the concentrated essence of tomato. We use whole peeled San Marzano tomatoes because crushed ones are often lower quality.',
                outcome: 'A deep red, thick jam-like consistency. No watery separation around the edges of the plate.',
                meta: ['5m Prep', '45m Cook', 'Makes 3 Cups'],
                ing: [
                    '2 cans (28oz) Whole Peeled San Marzano Tomatoes',
                    '1/4 cup Extra Virgin Olive Oil',
                    '4 cloves garlic (smashed whole, then removed, or minced for stronger flavor)',
                    '1 sprig fresh basil',
                    '1 tsp sugar (to balance acidity)'
                ],
                ins: [
                    '<strong>1. Oil Infusion</strong><br>Heat oil. Add garlic. Cook slowly until golden. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> If using whole cloves, remove them now for a subtle aroma. If minced, add tomatoes immediately before they burn.</span>',
                    '<strong>2. The Crush</strong><br>Pour tomatoes into a bowl and crush by hand (messy but best texture). Add to pot.',
                    '<strong>3. The Simmer</strong><br>Add basil sprig. Simmer gentle for 45 mins. The sauce creates its own sweetness as water evaporates.',
                    '<strong>4. Finish</strong><br>Remove basil. Season with salt. If too acidic, add sugar.'
                ]
            },
            {
                id: 'burger-sauce', cat: 'Ch 6: Sauces', title: 'Spicy Burger & Fry Sauce',
                img: 'Spicy Sauce',
                intro: 'The "Secret Sauce" of every great burger joint. It\'s an emulsion of mayo (fat), ketchup (sweet/acid), and pickle juice (brine).',
                outcome: 'Pale orange-pink color. Tangy, creamy, with a late kick of heat.',
                meta: ['5m Prep', '0m Cook', 'Makes 1 Cup'],
                ing: [
                    '1/2 cup Mayonnaise (Hellmann\'s or Dukes)',
                    '2 tbsp Ketchup',
                    '1 tsp Yellow Mustard',
                    '1 tbsp Pickle Brine',
                    '1 tsp Smoked Paprika + 1/2 tsp Cayenne'
                ],
                ins: [
                    '<strong>1. Whisk</strong><br>Combine all ingredients.',
                    '<strong>2. Rest</strong><br>Let sit in fridge for 30 mins to let flavors meld. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Keeps for 2 weeks. Use on everything.</span>'
                ]
            },
            {
                id: 'butter-sauce', cat: 'Ch 6: Sauces', title: 'Butter Chicken Burger Sauce',
                img: 'Butter Chicken Sauce',
                intro: 'A fusion condiment that brings the complex spice of India to a sandwich spread.',
                outcome: 'Golden yellow, aromatic, and savory.',
                meta: ['5m Prep', '0m Cook', 'Makes 1 Cup'],
                ing: [
                    '1/2 cup Mayo',
                    '1 tbsp Melted Butter (cooled)',
                    '1 tsp Garam Masala',
                    '1/2 tsp Turmeric',
                    '1 tsp Tomato Paste'
                ],
                ins: [
                    '<strong>1. Bloom Spices</strong><br>Microwave the butter with the spices for 10 seconds to wake them up.',
                    '<strong>2. Emulsify</strong><br>Whisk spiced butter into the mayo/tomato paste mix.'
                ]
            },
            {
                id: 'mint-yogurt', cat: 'Ch 6: Sauces', title: 'Mint Yogurt Sauce',
                img: 'Mint Yogurt',
                intro: 'The cooling fire-extinguisher for spicy tandoori dishes. Fresh mint provides the high note; yogurt provides the fat.',
                outcome: 'Pale green. Thin enough to drizzle but thick enough to hold shape.',
                meta: ['5m Prep', '0m Cook', 'Makes 1 Cup'],
                ing: [
                    '1 cup Plain Yogurt (whisked smooth)',
                    '1/2 cup Fresh Mint leaves',
                    '1/4 cup Fresh Cilantro',
                    '1 Green Chilli (optional)',
                    '1 tsp Cumin Powder'
                ],
                ins: [
                    '<strong>1. Blitz</strong><br>Blend herbs and chilli with a splash of water until it\'s a green paste.',
                    '<strong>2. Fold</strong><br>Stir the green paste into the yogurt. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Do not blend the yogurt or it will turn watery. Stir by hand.</span>'
                ]
            },
            {
                id: 'aioli', cat: 'Ch 6: Sauces', title: 'Garlic Aioli',
                img: 'Aioli',
                intro: 'Real Aioli is garlic and oil emulsified. We cheat by using mayo as a stable base, but we ramp up the garlic and acid to cut through fatty dishes.',
                outcome: 'Punchy garlic flavor that lingers. Thick enough to stand a spoon in.',
                meta: ['5m Prep', '0m Cook', 'Makes 1 Cup'],
                ing: [
                    '1/2 cup Mayo',
                    '2 cloves Garlic (grated into a paste)',
                    '1 tsp Lemon Juice',
                    '1 tbsp Good Olive Oil',
                    'Black Pepper'
                ],
                ins: [
                    '<strong>1. Paste</strong><br>Microplane the garlic. Big chunks of raw garlic are unpleasant.',
                    '<strong>2. Whisk</strong><br>Combine all. The olive oil gives it a grassy, luxury finish.'
                ]
            },
            {
                id: 'pesto', cat: 'Ch 6: Sauces', title: 'Fresh Basil Pesto',
                img: 'Pesto',
                intro: 'Pesto means "to pound". A mortar and pestle is best, but a food processor works if you pulse carefully to avoid heating the herbs (which turns them brown).',
                outcome: 'Electric bright green. If it turns olive-drab, the basil cooked from the blades\' heat.',
                meta: ['10m Prep', '0m Cook', 'Makes 1 Cup'],
                ing: [
                    '2 cups Fresh Basil (packed)',
                    '1/3 cup Pine Nuts (toasted)',
                    '1/2 cup Parmesan',
                    '1/2 cup Extra Virgin Olive Oil',
                    '2 cloves Garlic'
                ],
                ins: [
                    '<strong>1. Toast</strong><br>Toast nuts in dry pan for 2 mins. Cool.',
                    '<strong>2. Pulse</strong><br>Pulse garlic and nuts. Add basil. Pulse sparingly.',
                    '<strong>3. Stream</strong><br>With machine running, stream in oil slowly to emulsify. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Stir cheese in by hand at the end for better texture.</span>'
                ]
            },

            // CHAPTER 7: Desserts
            {
                id: 'cheesecake', cat: 'Ch 7: Desserts', title: 'Classic New York Cheesecake',
                img: 'New York Cheesecake',
                intro: 'Cheesecake is a custard, not a cake. It demands a water bath (bain-marie) and a slow cool-down to prevent the dreaded "Grand Canyon" crack in the center.',
                outcome: 'A dense, velvety texture with no graininess. The top should be flat and pale (no browning).',
                meta: ['1.5h Cook', '6h Chill', '12 Servings'],
                ing: [
                    'Crust: 1.5 cups Graham Cracker crumbs, 6 tbsp melted butter',
                    'Filling: 900g Full-Fat Cream Cheese (Room Temp is MANDATORY)',
                    '1.5 cups Sugar',
                    '4 Large Eggs (Room Temp)',
                    '1 cup Sour Cream (Room Temp, for tang)',
                    '1 tsp Vanilla Bean Paste'
                ],
                ins: [
                    '<strong>1. The Base</strong><br>Press crust into springform pan. Bake 10 mins. Cool.',
                    '<strong>2. The Emulsion</strong><br>Beat cream cheese and sugar until creamy. Scrape bowl. Add sour cream/vanilla.',
                    '<strong>3. The Eggs (Gentle)</strong><br>Add eggs one at a time. Mix on LOW. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Do not whip air into it. Air bubbles = surface cracks.</span>',
                    '<strong>4. The Bain-Marie</strong><br>Wrap pan in foil (double layer) to waterproof. Place in large roasting pan. Fill roasting pan with boiling water halfway up the cake pan.',
                    '<strong>5. Bake & Cool</strong><br>Bake at 160Â°C (325Â°F) for 60-70 mins until edges set but center wobbles like Jello. Turn oven OFF. Open door slightly. Let cool INSIDE for 1 hour.'
                ]
            },
            {
                id: 'lava-cake', cat: 'Ch 7: Desserts', title: 'Molten Chocolate Lava Cake',
                img: 'Lava Cake',
                intro: 'This is not raw batter; it is a cake cooked on the outside and liquid on the inside due to thermodynamics. Timing is everything.',
                outcome: 'firm walls that hold shape. When spooned, a river of hot chocolate lava should flow out slowly.',
                meta: ['15m Prep', '12m Cook', '4 Servings'],
                ing: [
                    '115g High-Quality Dark Chocolate (60% or higher)',
                    '1/2 cup Butter',
                    '2 Eggs + 2 Yolks (Richness)',
                    '1/4 cup Sugar',
                    '2 tbsp Flour (Structure)'
                ],
                ins: [
                    '<strong>1. Melt</strong><br>Melt butter and chocolate together gently.',
                    '<strong>2. Ribbon Stage</strong><br>Whip eggs and sugar until pale yellow and thick (ribbon stage). Fold in chocolate. Fold in flour.',
                    '<strong>3. Prep</strong><br>Butter ramekins. Dust with Cocoa Powder (not flour, or you get white streaks).',
                    '<strong>4. Bake</strong><br>220Â°C (425Â°F) - High Heat. Bake 12-14 mins. Edges firm, center soft. Unmold immediately.'
                ]
            },
            {
                id: 'panna-cotta', cat: 'Ch 7: Desserts', title: 'Silky Vanilla Panna Cotta',
                img: 'Panna Cotta',
                intro: 'Panna Cotta means "Cooked Cream". It relies on gelatin, not eggs. The perfect panna cotta should wobble like a "woman\'s thigh" (old chef saying) and melt instantly on the tongue.',
                outcome: 'Smooth, glass-like surface. It should jiggle when the plate is tapped, not stand rigid like rubber.',
                meta: ['4h Chill', 'Elegant', '6 Servings'],
                ing: [
                    '3 tsp Powdered Gelatin',
                    '1/4 cup Cold Milk (to bloom)',
                    '2 cups Heavy Cream',
                    '1 cup Whole Milk',
                    '1/2 cup Sugar',
                    '1 Vanilla Bean (seeds scraped)'
                ],
                ins: [
                    '<strong>1. Bloom</strong><br>Sprinkle gelatin over cold milk. Let sit 5 mins to hydrate.',
                    '<strong>2. Dissolve</strong><br>Heat cream, milk, sugar, vanilla. Do NOT boil. Once hot, remove from heat. Whisk in gelatin mix until dissolved.',
                    '<strong>3. Cool</strong><br>Pour into ramekins. <span class="pro-tip"><strong>ðŸ’¡ Pro Tip:</strong> Stir the mix occasionally as it cools before pouring. This prevents vanilla seeds from sinking to the bottom.</span>',
                    '<strong>4. Set</strong><br>Fride 4 hours. Unmold by dipping ramekin in warm water for 5 seconds.'
                ]
            },
            {
                id: 'tiramisu', cat: 'Ch 7: Desserts', title: 'Classic Tiramisu',
                img: 'Tiramisu',
                intro: 'No baking required. Just patience. We use raw egg yolks (pasteurized) for richness and Mascarpone. The coffee dip must be quick.',
                outcome: 'Distinct layers. Ladyfingers should be moist but not mushy. Cream should be stiff enough to slice.',
                meta: ['24h Chill', 'No Bake', '9 Servings'],
                ing: [
                    '6 Egg Yolks',
                    '3/4 cup Sugar',
                    '500g Mascarpone Cheese (Cold)',
                    '1.5 cups Strong Espresso (Cooled)',
                    'Package of Ladyfingers (Savoiardi)',
                    'Cocoa Powder for dusting'
                ],
                ins: [
                    '<strong>1. Sabayon</strong><br>Beat yolks and sugar over a double boiler until pale and hot (cooks the eggs). Cool slightly.',
                    '<strong>2. The Cream</strong><br>Fold Mascarpone into the egg mix. Whip until stiff peaks form.',
                    '<strong>3. The Dip</strong><br>Quickly dunk ladyfinger in coffee (1 second per side). arrange in dish. Top with cream. Repeat.',
                    '<strong>4. The Wait</strong><br>Chill 24 hours. The flavors need to marry. Dust with cocoa before serving.'
                ]
            },
            {
                id: 'gulab-jamun', cat: 'Ch 7: Desserts', title: 'Gulab Jamun (Rose Dumplings)',
                img: 'Gulab Jamun',
                intro: 'The most famous Indian dessert. Milk solids (Khoya or Milk Powder) fried slowly until dark gold, then soaked in a rose-cardamom syrup.',
                outcome: 'Spongy, not dense. When you bite, syrup should squeeze out. No hard center.',
                meta: ['30m Prep', '20m Cook', '12 Pieces'],
                ing: [
                    '1 cup Milk Powder',
                    '1/4 cup All Purpose Flour',
                    '2 tbsp Ghee (Clarified Butter)',
                    'Milk (for kneading)',
                    'Syrup: 2 cups Sugar, 2 cups Water, Cardamom, Rose Water'
                ],
                ins: [
                    '<strong>1. The Dough</strong><br>Mix milk powder, flour, ghee. Add milk spoon by spoon to make a soft, sticky dough. Do not over-knead.',
                    '<strong>2. Shaping</strong><br>Grease hands. Roll into smooth balls. ANY crack will split in the oil.',
                    '<strong>3. The Fry</strong><br>Fry in Ghee/Oil on LOW heat. If heat is high, outside burns, inside stays raw. Stir oil constantly to rotate balls.',
                    '<strong>4. The Soak</strong><br>Drop hot balls into warm syrup. Let soak 2 hours. They will double in size.'
                ]
            }
        ];

        // RENDER LOGIC
        const navList = document.getElementById('nav-list');
        const mainContent = document.getElementById('main-content');
        const searchBox = document.getElementById('search-box');

        let currentCat = '';

        function renderNav(filter = '') {
            navList.innerHTML = '';
            currentCat = '';
            const filtered = recipes.filter(r => r.title.toLowerCase().includes(filter.toLowerCase()));

            filtered.forEach(r => {
                // Category Header
                if (r.cat !== currentCat) {
                    const catEl = document.createElement('li');
                    catEl.className = 'nav-category';
                    catEl.textContent = r.cat;
                    navList.appendChild(catEl);
                    currentCat = r.cat;
                }
                // Item
                const li = document.createElement('li');
                li.className = 'nav-item';
                li.innerHTML = `<i class="fas fa-utensil-spoon"></i> ${r.title}`;
                li.onclick = () => activateRecipe(r.id);
                // IDs matching logic for active class
                if (document.getElementById(r.id)?.classList.contains('active')) li.classList.add('active');
                navList.appendChild(li);
            });
        }

        function renderRecipes() {
            // Clear existing views to prevent duplicates on update
            document.querySelectorAll('.recipe-view').forEach(el => el.remove());

            recipes.forEach((r) => {
                const safeTitle = r.img.replace(/ /g, '%20');
                const imgUrl = r.img.startsWith('http')
                    ? r.img
                    : `https://image.pollinations.ai/prompt/widescreen%20hd%20shot%20of%20${safeTitle},%20professional%20food%20photography,%20michelin%20star%20plating,%20cinematic%20lighting,%208k,%20depth%20of%20field?width=800&height=500&nologo=true&seed=${r.id}`;

                const view = document.createElement('div');
                view.className = `recipe-view`;
                view.id = r.id;

                view.innerHTML = `
                    <div class="recipe-header">
                        <div class="recipe-image-wrapper">
                            <img src="${imgUrl}" alt="${r.title}" class="recipe-image" loading="lazy">
                        </div>
                        <h2 class="recipe-title">${r.title}</h2>
                        <div class="recipe-meta-row">
                            ${r.meta.map(m => `<span class="meta-tag"><i class="fas fa-certificate"></i> ${m}</span>`).join('')}
                        </div>
                    </div>
                        <div class="pro-approach">
                            <h3><i class="fas fa-user-tie"></i> The Professional Approach</h3>
                            <p>${r.intro || 'Details coming soon...'}</p>
                        </div>
                        <div class="recipe-grid">
                            <div class="ingredients-card">
                                <h3><i class="fas fa-shopping-basket"></i> Ingredients</h3>
                                <ul class="ingredients-list">${r.ing.map(i => `<li>${i}</li>`).join('')}</ul>
                            </div>
                            <div class="instructions-card">
                                <h3><i class="fas fa-fire-burner"></i> Professional Instructions</h3>
                                <ol class="instructions-list">${r.ins.map(i => `<li>${i}</li>`).join('')}</ol>
                            </div>
                        </div>
                        <div class="success-metrics">
                            <h3><i class="fas fa-star"></i> What Success Looks Like</h3>
                            <p>${r.outcome || 'Golden, delicious, and perfect.'}</p>
                        </div>
                    `;
                mainContent.appendChild(view);
            });
        }

        window.activateRecipe = function (id) {
            // Hide welcome
            document.getElementById('welcome-view').style.display = 'none';
            // Hide all recipes
            document.querySelectorAll('.recipe-view').forEach(el => el.classList.remove('active'));
            // Show target
            document.getElementById(id).classList.add('active');

            // Nav Active State
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            // Refind nav item (simple approach: loop all nav items and text match? No, we need ID linkage)
            // Re-rendering nav is overkill. We can just add ID to li.
            // But for now, simple Highlight based on text index is okay or just leave it.
            // IMPROVEMENT: Re-render nav to highlight correct item is easiest
            // renderNav(searchBox.value); // This might reset scroll.

            // Mobile: Close sidebar
            if (window.innerWidth < 900) document.querySelector('.sidebar').classList.remove('open');
            mainContent.scrollTop = 0;
        }

        // Init
        renderNav();
        renderRecipes();

        // Search
        searchBox.addEventListener('input', (e) => {
            renderNav(e.target.value);
        });
    </script>



    <!-- BOT 1: RECIPE CUSTOMIZER (Top-Left) -->
    <div id="chatbot-custom">
        <button class="chatbot-toggle" id="chat-toggle-custom" title="Recipe Editor">
            <i class="fas fa-magic"></i>
            <span class="chatbot-pulse"></span>
        </button>
        <div class="chatbot-window" id="chat-window-custom">
            <div class="chat-header" style="background: #e3f2fd;">
                <div>
                    <h4 style="color: #1565c0;">ðŸŽ¨ Recipe Editor</h4>
                    <div style="font-size:0.7rem; opacity:0.8;">"Make it vegan", "More spicy"...</div>
                </div>
                <button class="chat-close" id="chat-close-custom"><i class="fas fa-times"></i></button>
            </div>
            <div class="chat-messages" id="chat-messages-custom">
                <div class="chat-msg bot">
                    <div class="chat-bubble">I am the Recipe Editor. Tell me how to change this recipe (e.g. "Make it
                        vegan", "Scale to 4 people") and I will update the page!</div>
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="chat-input-custom" placeholder="How should I change this recipe?">
                <button id="mic-btn-custom" class="mic-btn"><i class="fas fa-microphone"></i></button>
                <button id="chat-send-custom"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <!-- BOT 2: SOUS-CHEF (Bottom-Right) -->
    <div id="chatbot-main">
        <button class="chatbot-toggle" id="chat-toggle-main" title="Ask the Sous-Chef">
            <i class="fas fa-user-graduate"></i>
        </button>
        <div class="chatbot-window" id="chat-window-main">
            <div class="chat-header">
                <div>
                    <h4>ðŸ‘¨â€ðŸ³ Sous-Chef</h4>
                    <div style="font-size:0.7rem; opacity:0.8;">Ask about cooking tips!</div>
                </div>
                <button class="chat-close" id="chat-close-main"><i class="fas fa-times"></i></button>
            </div>
            <div class="chat-messages" id="chat-messages-main">
                <div class="chat-msg bot">
                    <div class="chat-bubble">Hello! I'm Aabaan's Sous-Chef. Ask me anything about cooking techniques or
                        ingredients!</div>
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="chat-input-main" placeholder="Ask a cooking question...">
                <button id="mic-btn-main" class="mic-btn"><i class="fas fa-microphone"></i></button>
                <button id="chat-send-main"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <style>
        .mic-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f1f1f1;
            color: #666;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            margin-right: 5px;
        }

        .mic-btn:hover {
            background: #e0e0e0;
            color: #333;
        }

        .mic-btn.recording {
            background: #ff4757;
            color: white;
            animation: pulse-mic 1.5s infinite;
        }

        @keyframes pulse-mic {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 71, 87, 0.4);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(255, 71, 87, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(255, 71, 87, 0);
            }
        }
    </style>

    <script>
        // ... (Existing render logic) ...
        const API_KEY = '%%OPENAI_API_KEY%%';
        const DEEPGRAM_API_KEY = '%%DEEPGRAM_API_KEY%%';

        // --- DEEPGRAM VOICE LOGIC ---
        async function setupVoice(btnId, inputId) {
            const btn = document.getElementById(btnId);
            const input = document.getElementById(inputId);
            let mediaRecorder;
            let audioChunks = [];
            let isRecording = false;

            btn.addEventListener('click', async () => {
                if (!isRecording) {
                    try {
                        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                        mediaRecorder = new MediaRecorder(stream, { mimeType: 'audio/webm' });

                        mediaRecorder.ondataavailable = event => {
                            if (event.data.size > 0) audioChunks.push(event.data);
                        };

                        mediaRecorder.onstop = async () => {
                            const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                            audioChunks = []; // Reset

                            // Send to Deepgram
                            const response = await fetch('https://api.deepgram.com/v1/listen?model=nova-2&smart_format=true', {
                                method: 'POST',
                                headers: {
                                    'Authorization': `Token ${DEEPGRAM_API_KEY}`,
                                    'Content-Type': 'audio/webm'
                                },
                                body: audioBlob
                            });

                            const data = await response.json();
                            if (data.results && data.results.channels[0].alternatives[0]) {
                                const transcript = data.results.channels[0].alternatives[0].transcript;
                                if (transcript) {
                                    input.value = transcript;
                                    input.focus();
                                }
                            }

                            // Stop tracks to release mic
                            stream.getTracks().forEach(track => track.stop());
                        };

                        mediaRecorder.start();
                        isRecording = true;
                        btn.classList.add('recording');
                        btn.innerHTML = '<i class="fas fa-stop"></i>'; // Change icon to Stop
                    } catch (err) {
                        console.error('Mic Error:', err);
                        alert('Could not access microphone.');
                    }
                } else {
                    mediaRecorder.stop();
                    isRecording = false;
                    btn.classList.remove('recording');
                    btn.innerHTML = '<i class="fas fa-microphone"></i>'; // Change icon to Mic
                }
            });
        }

        // Initialize Voice for both bots
        setupVoice('mic-btn-custom', 'chat-input-custom');
        setupVoice('mic-btn-main', 'chat-input-main');

        // --- BOT 1 LOGIC (CUSTOMIZER) ---
        const customToggle = document.getElementById('chat-toggle-custom');
        const customWindow = document.getElementById('chat-window-custom');
        const customClose = document.getElementById('chat-close-custom');
        const customMsgs = document.getElementById('chat-messages-custom');
        const customInput = document.getElementById('chat-input-custom');
        const customSend = document.getElementById('chat-send-custom');

        let customOpen = false;
        let customHistory = [];
        const CUSTOM_SYSTEM_PROMPT = `
You are the "Recipe Customization Assistant". Your job is to UPDATE the recipe page based on user requests.
IF the user asks to change the recipe (e.g. "make it vegan", "more spicy"), output a JSON block to update the page.
<<<UPDATE_RECIPE
{
  "id": "CURRENT_RECIPE_ID",
  "ing": ["..."],
  "ins": ["..."],
  "intro": "...",
  "outcome": "..."
}
>>>
RECIPE DATA: ${JSON.stringify(recipes)}
`;

        customToggle.addEventListener('click', () => { customOpen = !customOpen; customWindow.classList.toggle('open', customOpen); });
        customClose.addEventListener('click', () => { customOpen = false; customWindow.classList.remove('open'); });

        async function sendCustom() {
            const txt = customInput.value.trim();
            if (!txt) return;
            addMsg(customMsgs, 'user', txt);
            customInput.value = '';
            customHistory.push({ role: 'user', content: txt });
            const typing = addMsg(customMsgs, 'bot', 'Updating recipe...');

            try {
                const res = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${API_KEY}` },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [{ role: 'system', content: CUSTOM_SYSTEM_PROMPT }, ...customHistory],
                        max_tokens: 800
                    })
                });

                if (!res.ok) {
                    const errorData = await res.json().catch(() => ({}));
                    throw new Error(errorData.error?.message || `API Error: ${res.status}`);
                }

                const data = await res.json();
                if (typing) typing.remove();
                let reply = data.choices[0].message.content;

                // JSON PARSING LOGIC HERE (Same as before)
                const jsonMatch = reply.match(/<<<UPDATE_RECIPE([\s\S]*?)>>>/);
                if (jsonMatch) {
                    try {
                        const jsonStr = jsonMatch[1];
                        const updates = JSON.parse(jsonStr);
                        // FIND CURRENT ACTIVE RECIPE ID
                        const activeId = document.querySelector('.recipe-view.active')?.id;
                        if (activeId) updates.id = activeId; // Force current ID if AI misses it

                        const recipe = recipes.find(r => r.id === updates.id);
                        if (recipe) {
                            if (updates.ing) recipe.ing = updates.ing;
                            if (updates.ins) recipe.ins = updates.ins;
                            if (updates.intro) recipe.intro = updates.intro;
                            if (updates.outcome) recipe.outcome = updates.outcome;
                            renderRecipes();
                            setTimeout(() => { activateRecipe(updates.id); }, 50);
                            reply = "âœ… Recipe updated on page!";
                        }
                    } catch (e) { console.error(e); }
                }

                addMsg(customMsgs, 'bot', reply);
                customHistory.push({ role: 'assistant', content: reply });
            } catch (err) {
                if (typing) typing.remove();
                console.error(err);
                addMsg(customMsgs, 'bot', 'âš ï¸ <b>Error:</b> ' + err.message + '<br><small>Check API Key or Network.</small>');
            }
        }
        customSend.addEventListener('click', sendCustom);
        customInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') sendCustom(); });


        // --- BOT 2 LOGIC (SOUS-CHEF) ---
        const mainToggle = document.getElementById('chat-toggle-main');
        const mainWindow = document.getElementById('chat-window-main');
        const mainClose = document.getElementById('chat-close-main');
        const mainMsgs = document.getElementById('chat-messages-main');
        const mainInput = document.getElementById('chat-input-main');
        const mainSend = document.getElementById('chat-send-main');

        let mainOpen = false;
        let mainHistory = [];
        const MAIN_SYSTEM_PROMPT = `You are Aabaan's Sous-Chef. Answer general cooking questions. Context: ${document.body.innerText.substring(0, 2000)}`;

        mainToggle.addEventListener('click', () => { mainOpen = !mainOpen; mainWindow.classList.toggle('open', mainOpen); });
        mainClose.addEventListener('click', () => { mainOpen = false; mainWindow.classList.remove('open'); });

        async function sendMain() {
            const txt = mainInput.value.trim();
            if (!txt) return;
            addMsg(mainMsgs, 'user', txt);
            mainInput.value = '';
            mainHistory.push({ role: 'user', content: txt });
            const typing = addMsg(mainMsgs, 'bot', 'Thinking...');

            try {
                const res = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${API_KEY}` },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [{ role: 'system', content: MAIN_SYSTEM_PROMPT }, ...mainHistory],
                        max_tokens: 300
                    })
                });

                if (!res.ok) {
                    const errorData = await res.json().catch(() => ({}));
                    throw new Error(errorData.error?.message || `API Error: ${res.status}`);
                }

                const data = await res.json();
                if (typing) typing.remove();
                const reply = data.choices[0].message.content;
                addMsg(mainMsgs, 'bot', reply);
                mainHistory.push({ role: 'assistant', content: reply });
            } catch (err) {
                if (typing) typing.remove();
                console.error(err);
                addMsg(mainMsgs, 'bot', 'âš ï¸ <b>Error:</b> ' + err.message + '<br><small>Check API Key or Network.</small>');
            }
        }
        mainSend.addEventListener('click', sendMain);
        mainInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') sendMain(); });


        // HELPER
        function addMsg(container, role, text) {
            const d = document.createElement('div');
            d.className = `chat-msg ${role}`;

            // Format Markdown
            let formatted = text;
            if (role === 'bot') {
                formatted = text
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.*?)\*/g, '<em>$1</em>')
                    .replace(/\n/g, '<br>');
            }

            d.innerHTML = `<div class="chat-bubble">${formatted}</div>`;
            container.appendChild(d);
            container.scrollTop = container.scrollHeight;
            return d;
        }
    </script>
</body>

</html>